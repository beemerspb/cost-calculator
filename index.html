<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Калькулятор себестоимости</title>
  <link rel="manifest" href="manifest.json">
  <link rel="icon" href="https://fonts.gstatic.com/s/i/materialiconsoutlined/calculator/v6/24px.svg" sizes="192x192">
  <link rel="apple-touch-icon" href="https://fonts.gstatic.com/s/i/materialiconsoutlined/calculator/v6/48px.svg">
  <meta name="theme-color" content="#4fc3f7">
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons+Outlined" rel="stylesheet">
  <link rel="stylesheet" href="styles.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.25/jspdf.plugin.autotable.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/xlsx-js-style@1.2.0/dist/xlsx-js-style.min.js"></script>
  <script src="lang.js"></script>
  <script src="func.js"></script>
</head>
<body>
<div class="container">
  <h2>
    <span id="appTitle">Калькулятор себестоимости</span>
  </h2>

  <div class="settings-group">
    <div class="settings-item">
      <label for="languageSelect"><span class="material-icons-outlined">language</span> <span id="languageLabel">Язык:</span></label>
      <select id="languageSelect" onchange="changeLanguage()">
        <option value="ru">Русский</option>
        <option value="ro">Română</option>
        <option value="en">English</option>
        <option value="de">Deutsch</option>
      </select>
    </div>
    
    <div class="settings-item">
      <label for="currencySelect"><span class="material-icons-outlined">paid</span> <span id="currencyLabel">Валюта:</span></label>
      <select id="currencySelect" onchange="changeCurrency()">
        <option value="EUR">EUR (€)</option>
        <option value="RUB">RUB (₽)</option>
        <option value="USD">USD ($)</option>
        <option value="MDL">MDL (L)</option>
      </select>
    </div>
  </div>

  <div class="form-container">
    <div class="form-group">
      <label for="recipeName">
        <span id="recipeNameLabel">Название рецепта:</span>
      </label>
      <input type="text" id="recipeName" class="required" placeholder="" required>
    </div>
  </div>

  <div class="table-container">
    <table id="costTable">
      <thead>
        <tr>
          <th><span class="material-icons-outlined">shopping_basket</span> <span id="ingredientHeader">Ингридиент</span></th>
          <th><span class="material-icons-outlined">scale</span> <span id="quantityHeader">Кол-во в упак.</span></th>
          <th><span class="material-icons-outlined">attach_money</span> <span id="priceHeader">Цена упак.</span></th>
          <th><span class="material-icons-outlined">exposure_plus_1</span> <span id="addedHeader">Добавляемое</span></th>
          <th><span class="material-icons-outlined">sum</span> <span id="sumHeader">Сумма</span></th>
          <th><span class="material-icons-outlined">delete</span></th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
    <button onclick="addRow()" class="secondary" style="margin-top: 10px;">
      <span class="material-icons-outlined">add</span>
      <span id="addButton">Добавить</span>
    </button>
  </div>

  <div class="table-container">
    <table id="pieceGoodsTable">
      <thead>
        <tr>
          <th><span class="material-icons-outlined">inventory_2</span> <span id="pieceGoodsHeader">Штучный товар</span></th>
          <th><span class="material-icons-outlined">numbers</span> <span id="countHeader">Кол-во</span></th>
          <th><span class="material-icons-outlined">payments</span> <span id="piecePriceHeader">Цена</span></th>
          <th><span class="material-icons-outlined">sum</span> <span id="pieceSumHeader">Сумма</span></th>
          <th><span class="material-icons-outlined">delete</span></th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
    <button onclick="addPieceGoodsRow()" class="secondary" style="margin-top: 10px;">
      <span class="material-icons-outlined">add</span>
      <span id="addPieceButton">Добавить</span>
    </button>
  </div>

  <div class="table-container">
    <table id="electricityTable">
      <thead>
        <tr>
          <th><span class="material-icons-outlined">bolt</span> <span id="electricityHeader">Электричество</span></th>
          <th><span class="material-icons-outlined">schedule</span> <span id="timeHeader">Время (ч)</span></th>
          <th><span class="material-icons-outlined">electrical_services</span> <span id="powerHeader">Мощность (кВт)</span></th>
          <th><span class="material-icons-outlined">payments</span> <span id="electricityPriceHeader">Цена</span></th>
          <th><span class="material-icons-outlined">sum</span> <span id="electricitySumHeader">Сумма</span></th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td><span id="energyCostsLabel">Энергозатраты</span></td>
          <td><input type="number" id="electricityHours" step="0.1" min="0" value="0" class="electricity-input"></td>
          <td><input type="number" id="electricityPower" step="0.1" min="0" value="0" class="electricity-input"></td>
          <td><input type="number" id="electricityPrice" step="0.01" min="0" value="0" class="electricity-input"></td>
          <td id="electricityCost">0.00</td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="table-container">
    <table id="totalTable">
      <thead>
        <tr>
          <th colspan="2"><span class="material-icons-outlined">receipt_long</span> <span id="totalCostsHeader">Итоговые затраты</span></th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td><span id="productsLabel">Продукты:</span></td>
          <td id="productsTotal">0.00</td>
        </tr>
        <tr>
          <td><span id="pieceGoodsLabel">Штучный товар:</span></td>
          <td id="pieceGoodsTotal">0.00</td>
        </tr>
        <tr>
          <td><span id="electricityLabel">Электричество:</span></td>
          <td id="electricityTotal">0.00</td>
        </tr>
        <tr id="finalTotalRow">
          <td><strong><span id="totalLabel">Общая сумма:</span></strong></td>
          <td id="finalTotal">0.00</td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="buttons-container">
    <button onclick="calculateAll()" class="success">
      <span class="material-icons-outlined">calculate</span>
      <span id="calculateButton">Рассчитать</span>
    </button>
    <button onclick="clearAllTables()" class="danger">
      <span class="material-icons-outlined">delete_sweep</span>
      <span id="clearButton">Очистить</span>
    </button>
    <button id="saveBtn" onclick="saveResult()" style="display: none;" class="secondary">
      <span class="material-icons-outlined">save</span>
      <span id="saveButton">Сохранить</span>
    </button>
  </div>

  <div class="saved-list" id="savedList">
    <div class="empty-state" id="emptyState">
      <span class="material-icons-outlined">inventory_2</span>
      <p id="emptyStateText">Сохранённые рецепты появятся здесь</p>
    </div>
  </div>
</div>
</body>
</html>
